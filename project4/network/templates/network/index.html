{% extends "network/layout.html" %}
{% load static %}

{% block body %}
    {% if profileUser %}
        {% block profile %}
        {% endblock %}
    {% else %}
        {% if user.is_authenticated %}
        <div id="newPostContainer">
            <button id="newPostButton" class="btn btn-primary">New Post</button>
            <div id="newPost">
                <form id="postForm" method="POST" action="{% url 'post' %}">
                    {% csrf_token %}
                    <div class="form-group">
                    <label for="post">New Post</label>
                    <input type="textarea" name="userPost" id="post" class="form-control" aria-describedby="postDesc">
                    <small id="postDesc" class="form-text text-muted">Post for everyone to see!</small>
                    </div>
                    <input type="submit" class="btn btn-primary" id="postSubmit" value="Post">
                </form>
                <button id="hideNew" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
        {% endif %}
    {% endif %}    

    

    {% for post in page_obj %}
        <div id="post" class="card">
            <div class="card-body">
                <a id="postUser" href="{% url 'profile' post.poster %}"><h5 class="card-title">{{ post.poster.username }}</h5></a>
                <h6 id="postTime" class="card-subtitle mb-2 text-muted">{{ post.timestamp }}</h6>
                <p id="postText" class="card-text">{{ post.post }}</p>
                {% if request.user == post.poster %}
                <form method="POST" id="editForm" action="{% url 'edit' %}">
                    {% csrf_token %}
                    <textarea name="postEdit" id="postTextArea"></textarea>
                    <input name="postID" type="hidden" value="{{ post.id }}">
                </form>
                {% endif %}
                <i class="fa fa-heart" style="font-size:24px"></i>
                </span><h6 id="likeInfo" class="card-subtitle mb-2 text-muted"><span class="glyphicon glyphicon-heart"></span> {{ post.likes }}</h6>
                {% if request.user == post.poster %}
                <button id="editButton" type="button" class="btn btn-primary btn-sm">Edit</button>
                <button id="saveButton" form="editForm" type="submit" class="btn btn-primary btn-sm">Save</button>
                {% endif %}
              </div>
        </div>
    {% endfor %}

    <nav aria-label="Page navigation">
        <ul class="pagination step-links">
                {% if page_obj.has_previous %}
                <li class="page-item"><a class="page-link" href="?page=1">&laquo; first</a></li>
                <li class="page-item"><a class="page-link" href="?page={{ page_obj.previous_page_number }}">previous</a></li>
                {% endif %}

                <li class="page-item disabled"><span class="current">
                    Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
                </span></li>
        
                {% if page_obj.has_next %}
                <li class="page-item"><a class="page-link" href="?page={{ page_obj.next_page_number }}">next</a></li>
                <li class="page-item"><a class="page-link" href="?page={{ page_obj.paginator.num_pages }}">last &raquo;</a></li>
                {% endif %}
        </ul>
    </nav>
{% endblock %}

{% block script %}
    <script src="{% static 'network/index.js' %}"></script>
{% endblock %}
